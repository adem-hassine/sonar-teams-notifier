FROM sonarqube:9.1-community
# setup ssh 
RUN apk add openssh procps openrc supervisor --no-cache && echo "root:root" | chpasswd && echo "PermitRootLogin Yes " >> /etc/ssh/sshd_config && rc-update add sshd && rc-status && $(/etc/init.d/sshd start || true) && touch /run/openrc/softlevel 
# in order to get image with multiple entrypoint and we can controle the sonarqube server inside a dockerimage we need to add supervisor config 
COPY supervisord.conf /etc/supervisord.conf
CMD /usr/bin/supervisord -c /etc/supervisord.conf
#ENTRYPOINT ["tail", "-f", "/dev/null"]
#CMD $(/etc/init.d/sshd start || true ) && touch /run/openrc/softlevel && /etc/init.d/sshd start && /opt/sonarqube/bin/run.sh
#$(/etc/init.d/sshd start ; touch /run/openrc/softlevel ; /etc/init.d/sshd start)
